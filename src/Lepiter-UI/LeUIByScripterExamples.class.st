"
I exemplify lepiter using {{gtClass:BlScripter}}.
I provide basic setups and support methods to simplify {{gtClass:LePageToolElement}} and {{gtClass:LeSnippetElement}} (sub-)instances.
#Add Snippet Support
The following method adds a snippet of a given name: {{gtMethod:LeUIByScripterExamples>>#addSnippetNamed:step: | label=#selector}}.
#Initial Page
The following example displays a default (empty) page: {{gtExample:LeUIByScripterExamples>>#emptyPageElement}}

"
Class {
	#name : #LeUIByScripterExamples,
	#superclass : #Object,
	#traits : 'TBlDevScripterExamples',
	#classTraits : 'TBlDevScripterExamples classTrait',
	#category : #'Lepiter-UI-Examples'
}

{ #category : #utilities }
LeUIByScripterExamples class >> inExample: aBlock [
	^ aBlock cull: self new
]

{ #category : #'examples - support' }
LeUIByScripterExamples >> addEmptyPageNamed: aPageTitle into: aDatabase [
	<gtExample>
	| aPage aPageCount aLinkCount |
	aPageCount := aDatabase pages size.
	aLinkCount := aDatabase explicitLinks size.

	aPage := aDatabase pageBuilder
			title: aPageTitle;
			add.

	self assert: aDatabase pages size equals: 1 + aPageCount.
	self assert: aDatabase explicitLinks size equals: aLinkCount.

	self assert: (aDatabase pageNamed: aPageTitle) == aPage.

	^ aPage
]

{ #category : #'examples - support' }
LeUIByScripterExamples >> addEmptyPageOneInto: database [
	<gtExample>
	^ self addEmptyPageNamed: self pageOneTitle into: database
]

{ #category : #'examples - support' }
LeUIByScripterExamples >> addEmptyPageTwoInto: database [
	<gtExample>
	^ self addEmptyPageNamed: self pageTwoTitle into: database
]

{ #category : #'examples - support' }
LeUIByScripterExamples >> addNewSnippetShortcut [
	<gtExample>
	^ BlKeyCombination builder
		shift;
		primary;
		key: BlKeyboardKey return;
		build
]

{ #category : #'examples - support' }
LeUIByScripterExamples >> addSnippetNamed: aSnippetName step: aParentStep [ 
	"I add a new snippet to a page as a second page child.
	I assume that the there is a {{gtClass:LePageToolElement}} instance.
	I assume that the lepiter database has at least one snippet.
	I assume that the first page snippet is a text snippet."
	<gtExample>
	
	| aSnippetsCount |
	aParentStep substeps: ('Add new {1} snippet' format: { aSnippetName }) do: [ :aStep |
	
		aStep do
			label: 'Find out the number of snippets';
			block: [ :aPageElement | aSnippetsCount := aPageElement pageViewModel pageModel children size ];
			onBreadthFirstChildOfClass: LePageToolElement;
			play.
			
		aStep shortcut
			label: 'Open add snippet spotter';
			combination: self addNewSnippetShortcut;
			in: [ :theStep | self targetPageInfiniteElement: theStep ];
			onChildAt: 1;
			id: GtSourceCoderEditorId;
			play.
			
		aStep type 
			text: aSnippetName;
			onSpaceRoot;
			onBreadthFirstChildOfClass: GtStreamingSpotterSearchField;
			play.
			
		aStep keyClick 
			label: ('Insert {1} snippet' format: { aSnippetName });
			key: BlKeyboardKey return;
			play.
			
		aStep assert 
			label: 'Page has two snippets';
			value: [ :aPageElement | aPageElement pageViewModel pageModel children size ] 
				equals: [ aSnippetsCount + 1 ];
			onBreadthFirstChildOfClass: LePageToolElement;
			play.
		
		aStep assert
			label: 'Assert picture widget is inserted';
			value: [ :anInfiniteElement | anInfiniteElement childrenCount  ] equals: [ 2 ];
			in: [ :theStep | self targetPageInfiniteElement: theStep ];
			play.
	]
]

{ #category : #'examples - support' }
LeUIByScripterExamples >> databaseOneIn: aLogicalDatabase [
	"Find Database One"

	<gtExample>
	| aDatabase |
	aDatabase := aLogicalDatabase databaseNamed: self databaseOneName.

	self assert: aDatabase isNotNil.
	self assert: aDatabase databaseName equals: self databaseOneName.

	^ aDatabase
]

{ #category : #'examples - database' }
LeUIByScripterExamples >> databaseOneName [
	^ 'Database One'
]

{ #category : #'examples - support' }
LeUIByScripterExamples >> databaseTwoIn: aLogicalDatabase [
	"Find Database Two"

	<gtExample>
	| aDatabase |
	aDatabase := aLogicalDatabase databaseNamed: self databaseTwoName.

	self assert: aDatabase isNotNil.
	self assert: aDatabase databaseName equals: self databaseTwoName.

	^ aDatabase
]

{ #category : #'examples - database' }
LeUIByScripterExamples >> databaseTwoName [
	^ 'Database Two'
]

{ #category : #'examples - database' }
LeUIByScripterExamples >> databaseWithPageOne [
	<gtExample>
	| database |
	database := self emptyDatabase.

	self addEmptyPageOneInto: database.

	^ database
]

{ #category : #'examples - database' }
LeUIByScripterExamples >> databaseWithPageTwo [
	<gtExample>
	| database |
	database := self emptyDatabase.

	self addEmptyPageTwoInto: database.

	^ database
]

{ #category : #'examples - database' }
LeUIByScripterExamples >> emptyDatabase [
	<gtExample>
	| database folderReference localStore  |
	folderReference := FileSystem memory / 'storage-main'.
	folderReference ensureCreateDirectory.
	
	localStore := LeLocalStoreLoad current.
	localStore localRoot: folderReference.
	database := localStore loadAndMonitorFrom: folderReference.
	self assert: database explicitLinks size equals: 0.
	^ database 
]

{ #category : #'examples - ui' }
LeUIByScripterExamples >> emptyPageElement [
	<gtExample>
	| aScripter |
	aScripter := self
			pageOneElementUsingDatabaseModel: [ self databaseWithPageOne ]
			extra: [ :anElement | anElement ].

	^ aScripter
]

{ #category : #'examples - ui' }
LeUIByScripterExamples >> emptyPageElementInPager [
	<gtExample>
	| aScripter |
	aScripter := self
			pageOneElementUsingDatabaseModel: [ self databaseWithPageOne ]
			extra: [ :anElement | GtPager createWrappedOn: anElement ].

	^ aScripter
]

{ #category : #'examples - ui' }
LeUIByScripterExamples >> emptyPageElementInPagerMaximized [
	<gtExample>
	| aScripter |
	aScripter := self
			pageOneElementUsingDatabaseModel: [ self databaseWithPageOne ]
			extra: [ :anElement | (GtPager createWrappedOn: anElement) maximized ].

	^ aScripter
]

{ #category : #'examples - ui' }
LeUIByScripterExamples >> logicalDatabasePageOneElementInPager [
	<gtExample>
	| aScripter |
	aScripter := self
			pageOneElementUsingDatabaseModel: [ self logicalDatabaseWithEmptyPage ]
			extra: [ :anElement | GtPager createWrappedOn: anElement ].

	^ aScripter
]

{ #category : #'examples - database' }
LeUIByScripterExamples >> logicalDatabaseWithEmptyPage [
	<gtExample>
	| database |
	database := self logicalDatabaseWithTwoEmptyDatabases.

	self addEmptyPageOneInto: database primaryDB.
	self assert: database pages size equals: 1.
	self
		assert: (database pageNamed: self pageOneTitle)
				== (database primaryDB pageNamed: self pageOneTitle).

	^ database
]

{ #category : #'examples - database' }
LeUIByScripterExamples >> logicalDatabaseWithTwoEmptyDatabases [
	<gtExample>
	| databaseOne databaseTwo database |
	databaseOne := self emptyDatabase.
	databaseTwo := self emptyDatabase.

	databaseOne databaseName: self databaseOneName.
	databaseTwo databaseName: self databaseTwoName.

	self assert: databaseOne databaseName equals: self databaseOneName.
	self assert: databaseTwo databaseName equals: self databaseTwoName.
	self assert: databaseOne uuidString isNotNil.
	self assert: databaseOne uuidString isNotEmpty.
	self assert: databaseTwo uuidString isNotNil.
	self assert: databaseTwo uuidString isNotEmpty.

	database := LeLogicalDatabase primaryDB: databaseOne.
	database addDB: databaseTwo.
	
	self assert: database databases size equals: 2.
	self assert: database pages size equals: 0.

	^ database
]

{ #category : #'examples - support' }
LeUIByScripterExamples >> pageOneElementUsingDatabaseModel: aModelBlock extra: anElementBlock [
	"I open a page element using #asLepiterPagePhlowTool
	aModelBlock is evaluated to get a database instance (that includes Pate One).
	anElementBlock is evaluated to, for example, wrap the page element into a pager."

	<gtExample>
	| aScripter |
	aScripter := self scripter.

	aScripter
		substeps: 'Prepare database'
		do: [ :aStep | 
			self
				scripter: aStep
				withModel: aModelBlock
				element: [ :aDatabase | 
					(self pageOneIn: aDatabase) asLepiterPagePhlowTool
						asElementDo: (anElementBlock ifNil: [ [ :anElement | anElement ] ]) ].

			aStep assert
				label: self pageOneTitle , ' element has one snippet widget';
				value: [ :anInfiniteElement | anInfiniteElement children size ]
					equals: [ 1 ];
				in: [ :theStep | self targetPageInfiniteElement: theStep ];
				play.

			aStep assert
				label: self pageOneTitle , ' has one snippet';
				value: [ :aDatabase | (self pageOneIn: aDatabase) children size ]
					equals: [ 1 ];
				onModel;
				play ].

	^ aScripter
]

{ #category : #'examples - support' }
LeUIByScripterExamples >> pageOneIn: aDatabase [
	"Find Page One"

	<gtExample>
	| aPage |
	aPage := aDatabase pageNamed: self pageOneTitle.

	self assert: aPage isNotNil.
	self assert: aPage title equals: self pageOneTitle.

	^ aPage
]

{ #category : #'examples - support' }
LeUIByScripterExamples >> pageOneTitle [
	^ 'Page One'
]

{ #category : #'examples - support' }
LeUIByScripterExamples >> pageTwoIn: aDatabase [
	"Find Page Two"

	<gtExample>
	| aPage |
	aPage := aDatabase pageNamed: self pageTwoTitle.

	self assert: aPage isNotNil.
	self assert: aPage title equals: self pageTwoTitle.

	^ aPage
]

{ #category : #'examples - support' }
LeUIByScripterExamples >> pageTwoTitle [
	^ 'Page Two'
]

{ #category : #'examples - support' }
LeUIByScripterExamples >> targetPageInfiniteElement: aStep [
	aStep
		onBreadthFirstChildOfClass: LePageToolElement;
		id: #content;
		id: #snippetsTree;
		id: #scrollable
]
